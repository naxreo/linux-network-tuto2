<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Linux Network Flow Map</title>
  <script src="https://unpkg.com/cytoscape@3.26.0/dist/cytoscape.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
      display: flex;
      height: 100vh;
      background: #0a0a0a;
      color: #e5e5e5;
      overflow: hidden;
    }

    #cy {
      flex: 1;
      background: #111;
      position: relative;
    }

    #info {
      width: 350px;
      padding: 20px;
      background: #1a1a1a;
      border-left: 1px solid #333;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    #info h3 {
      margin: 0 0 8px 0;
      color: #7dd3fc;
      font-size: 18px;
      border-bottom: 2px solid #2563eb;
      padding-bottom: 8px;
    }

    #info p {
      margin: 8px 0;
      line-height: 1.6;
      color: #d1d5db;
    }

    #info .desc {
      color: #9ca3af;
      font-size: 14px;
    }

    #info .function-list {
      margin-top: 12px;
      padding-left: 20px;
    }

    #info .function-list li {
      margin: 6px 0;
      color: #60a5fa;
      font-family: 'Courier New', monospace;
      font-size: 13px;
    }

    #info .level-badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      margin-right: 8px;
    }

    #controls {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(26, 26, 26, 0.9);
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #333;
      z-index: 1000;
    }

    #controls h4 {
      margin: 0 0 8px 0;
      color: #7dd3fc;
      font-size: 14px;
    }

    #controls .control-item {
      margin: 4px 0;
      font-size: 12px;
      color: #9ca3af;
    }

    #zoom-level {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(26, 26, 26, 0.9);
      padding: 8px 12px;
      border-radius: 6px;
      border: 1px solid #333;
      z-index: 1000;
      font-size: 12px;
      color: #60a5fa;
    }

    .legend {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #333;
    }

    .legend-item {
      display: flex;
      align-items: center;
      margin: 8px 0;
      font-size: 12px;
    }

    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      margin-right: 8px;
    }

    .group-label {
      position: absolute;
      font-size: 24px;
      font-weight: bold;
      color: #60a5fa;
      z-index: 1000;
      pointer-events: none;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
    }

    #rx-label {
      top: 50px;
      left: 50%;
      transform: translateX(-50%);
    }

    #tx-label {
      bottom: 50px;
      left: 50%;
      transform: translateX(-50%);
    }
  </style>
</head>
<body>

<div id="cy"></div>

<div id="info">
  <h3>Node Info</h3>
  <p class="desc">ë…¸ë“œë¥¼ í´ë¦­í•˜ì—¬ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
  <p class="desc">ë§ˆìš°ìŠ¤ íœ ë¡œ í™•ëŒ€/ì¶•ì†Œ, ë“œë˜ê·¸ë¡œ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</div>

<div id="controls">
  <h4>Controls</h4>
  <div class="control-item">ğŸ–±ï¸ ë“œë˜ê·¸: ì´ë™</div>
  <div class="control-item">ğŸ–±ï¸ íœ : í™•ëŒ€/ì¶•ì†Œ</div>
  <div class="control-item">âŒ¨ï¸ ë°©í–¥í‚¤: ì´ë™</div>
  <div class="control-item">âŒ¨ï¸ +/-: í™•ëŒ€/ì¶•ì†Œ</div>
  <div class="control-item">âŒ¨ï¸ ESC: ì „ì²´ ë³´ê¸°</div>
</div>

<div id="zoom-level">Zoom: 1.00x</div>

<div id="rx-label" class="group-label">RX (Receive Path)</div>
<div id="tx-label" class="group-label">TX (Transmit Path)</div>

<script>
// Zoom ë ˆë²¨ ì •ì˜
const ZOOM_LEVEL = {
  OVERVIEW: 0.5,
  HOOK: 1.2,
  TABLE: 1.8,
  FUNCTION: 2.5
};

// ê³„ì¸µë³„ ìƒ‰ìƒ ì •ì˜
const LEVEL_COLORS = {
  HARDWARE: '#ef4444',      // NIC - ë¹¨ê°„ìƒ‰
  DRIVER: '#f97316',        // Driver - ì£¼í™©ìƒ‰
  KERNEL_LOW: '#eab308',    // NAPI, skb - ë…¸ë€ìƒ‰
  NETFILTER: '#8b5cf6',     // Netfilter - ë³´ë¼ìƒ‰
  ROUTING: '#06b6d4',       // Routing - ì²­ë¡ìƒ‰
  SOCKET: '#10b981',        // Socket - ì´ˆë¡ìƒ‰
  XDP: '#ec4899',           // XDP - í•‘í¬ìƒ‰
  TC: '#6366f1',            // TC/qdisc - ì¸ë””ê³ ìƒ‰
  BUFFER: '#14b8a6',        // Buffer - í‹¸ìƒ‰
  USER: '#f59e0b',          // User-space - ì•°ë²„ìƒ‰
  KERNEL_OPTION: '#a855f7'  // Kernel Option - ë³´ë¼ìƒ‰
};

// ë…¸ë“œ ë°ì´í„° êµ¬ì¡°
const networkData = {
  nodes: [
    // RX ê²½ë¡œ
    { 
      id: 'nic-rx', 
      label: 'NIC', 
      level: 'HARDWARE', 
      desc: 'ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ ì¹´ë“œ',
      detailedDesc: 'ë¬¼ë¦¬ì  ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ ì¹´ë“œë¡œ, ì „ê¸° ì‹ í˜¸ë¥¼ ë°›ì•„ íŒ¨í‚·ì„ ìˆ˜ì‹ í•©ë‹ˆë‹¤. íŒ¨í‚·ì´ ë„ì°©í•˜ë©´ DMA(Direct Memory Access)ë¥¼ í†µí•´ ì»¤ë„ ë©”ëª¨ë¦¬ì˜ ring bufferì— íŒ¨í‚·ì„ ì§ì ‘ ì ì¬í•˜ê³ , í•˜ë“œì›¨ì–´ ì¸í„°ëŸ½íŠ¸ë¥¼ ë°œìƒì‹œì¼œ ì»¤ë„ì— íŒ¨í‚· ìˆ˜ì‹ ì„ ì•Œë¦½ë‹ˆë‹¤.',
      functions: ['interrupt handler'], 
      position: { x: 0, y: -250 } 
    },
    { 
      id: 'nic-rx-ring', 
      label: 'NIC RX Ring', 
      level: 'BUFFER', 
      desc: 'NIC ìˆ˜ì‹  ë§ ë²„í¼',
      detailedDesc: 'NIC í•˜ë“œì›¨ì–´ê°€ íŒ¨í‚·ì„ ìˆ˜ì‹ í•  ë•Œ DMAë¥¼ í†µí•´ ì»¤ë„ ë©”ëª¨ë¦¬ì— ì§ì ‘ ì ì¬í•˜ëŠ” ë§ ë²„í¼ì…ë‹ˆë‹¤. ë“œë¼ì´ë²„ê°€ ë¯¸ë¦¬ í• ë‹¹í•œ ë©”ëª¨ë¦¬ ì˜ì—­ìœ¼ë¡œ, í•˜ë“œì›¨ì–´ê°€ ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŒ¨í‚·ì´ ë„ì°©í•˜ë©´ ì´ ë²„í¼ì— ì €ì¥ë˜ê³ , ë“œë¼ì´ë²„ê°€ ì´ë¥¼ ì½ì–´ì„œ ì²˜ë¦¬í•©ë‹ˆë‹¤. ë§ ë²„í¼ëŠ” ìˆœí™˜ êµ¬ì¡°ë¡œ ë˜ì–´ ìˆì–´ ê³ ì† íŒ¨í‚· ì²˜ë¦¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.',
      functions: ['DMA', 'ring buffer descriptor'], 
      position: { x: 150, y: -200 } 
    },
    { 
      id: 'driver-rx', 
      label: 'Driver', 
      level: 'DRIVER', 
      desc: 'ë„¤íŠ¸ì›Œí¬ ì¹´ë“œ ë“œë¼ì´ë²„',
      detailedDesc: 'NIC í•˜ë“œì›¨ì–´ì™€ ì»¤ë„ ë„¤íŠ¸ì›Œí¬ ìŠ¤íƒì„ ì—°ê²°í•˜ëŠ” ë“œë¼ì´ë²„ì…ë‹ˆë‹¤. ì¸í„°ëŸ½íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ íŒ¨í‚· ìˆ˜ì‹ ì„ ê°ì§€í•˜ë©´, NAPI(New API) ìŠ¤ì¼€ì¤„ë§ì„ í†µí•´ ì¸í„°ëŸ½íŠ¸ ê¸°ë°˜ ì²˜ë¦¬ë¥¼ í´ë§ ê¸°ë°˜ìœ¼ë¡œ ì „í™˜í•©ë‹ˆë‹¤. ì´ëŠ” ê³ ì† ë„¤íŠ¸ì›Œí¬ì—ì„œ ì¸í„°ëŸ½íŠ¸ í­ì£¼ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•œ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.',
      functions: ['napi_schedule()', 'driver_poll()'], 
      position: { x: 300, y: -250 } 
    },
    { 
      id: 'xdp-rx', 
      label: 'XDP', 
      level: 'XDP', 
      desc: 'eBPF ê¸°ë°˜ ë“œë¼ì´ë²„ ë ˆë²¨ ì²˜ë¦¬ (ì˜µì…˜)',
      detailedDesc: 'XDP(eXpress Data Path)ëŠ” eBPF í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ì—¬ ë“œë¼ì´ë²„ ë ˆë²¨ì—ì„œ ë§¤ìš° ë¹ ë¥¸ íŒ¨í‚· ì²˜ë¦¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. skb ìƒì„± ì´ì „ ë˜ëŠ” ì§í›„ì— ì‹¤í–‰ë˜ë©°, Netfilterë³´ë‹¤ ë¨¼ì € ì²˜ë¦¬ë©ë‹ˆë‹¤. DROP(íŒ¨í‚· íê¸°), PASS(í†µê³¼), TX(ì¬ì „ì†¡), REDIRECT(ë‹¤ë¥¸ ì¸í„°í˜ì´ìŠ¤ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸) ë“±ì˜ ì•¡ì…˜ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. DDoS ë°©ì–´, ë¡œë“œ ë°¸ëŸ°ì‹±, íŒ¨í‚· í•„í„°ë§ ë“±ì— ì‚¬ìš©ë©ë‹ˆë‹¤.',
      functions: ['bpf_prog_run_xdp()', 'xdp_do_redirect()'], 
      position: { x: 450, y: -150 } 
    },
    { 
      id: 'napi-rx', 
      label: 'NAPI', 
      level: 'KERNEL_LOW', 
      desc: 'ì¸í„°ëŸ½íŠ¸ â†’ í´ë§ ì „í™˜',
      detailedDesc: 'NAPI(New API)ëŠ” ê³ ì† ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì—ì„œ ì¸í„°ëŸ½íŠ¸ í­ì£¼ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•œ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. ì´ˆê¸° ì¸í„°ëŸ½íŠ¸ í›„ì—ëŠ” í´ë§ ëª¨ë“œë¡œ ì „í™˜ë˜ì–´ ì—¬ëŸ¬ íŒ¨í‚·ì„ í•œ ë²ˆì— ì²˜ë¦¬í•©ë‹ˆë‹¤. ì´ëŠ” CPU íš¨ìœ¨ì„±ì„ í¬ê²Œ í–¥ìƒì‹œí‚µë‹ˆë‹¤. struct napi_struct êµ¬ì¡°ì²´ë¡œ ê´€ë¦¬ë˜ë©°, GRO(Generic Receive Offload)ì™€ í•¨ê»˜ ì‘ë™í•˜ì—¬ íŒ¨í‚·ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.',
      functions: ['napi_poll()', 'napi_gro_receive()'], 
      position: { x: 600, y: -250 } 
    },
    { 
      id: 'skb-rx', 
      label: 'sk_buff', 
      level: 'KERNEL_LOW', 
      desc: 'íŒ¨í‚· ë©”íƒ€ë°ì´í„° êµ¬ì¡°ì²´',
      detailedDesc: 'sk_buff(socket buffer)ëŠ” ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì—ì„œ ëª¨ë“  ë„¤íŠ¸ì›Œí¬ íŒ¨í‚·ì„ í‘œí˜„í•˜ëŠ” í•µì‹¬ ë°ì´í„° êµ¬ì¡°ì…ë‹ˆë‹¤. íŒ¨í‚· ë°ì´í„°ì™€ ë©”íƒ€ë°ì´í„°(í”„ë¡œí† ì½œ, ê¸¸ì´, ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤, ë¼ìš°íŒ… ì •ë³´ ë“±)ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. ì´ êµ¬ì¡°ì²´ëŠ” ë„¤íŠ¸ì›Œí¬ ìŠ¤íƒ ì „ì²´ë¥¼ í†µê³¼í•˜ë©°, ê° ê³„ì¸µì—ì„œ í•„ìš”í•œ ì •ë³´ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•©ë‹ˆë‹¤. ì£¼ìš” í•„ë“œë¡œëŠ” skb->data(íŒ¨í‚· ë°ì´í„°), skb->len(ê¸¸ì´), skb->protocol(í”„ë¡œí† ì½œ), skb->dev(ë„¤íŠ¸ì›Œí¬ ì¥ì¹˜) ë“±ì´ ìˆìŠµë‹ˆë‹¤.',
      functions: ['build_skb()', 'netif_receive_skb()'], 
      position: { x: 900, y: -250 } 
    },
    { 
      id: 'netfilter-rx', 
      label: 'Netfilter', 
      level: 'NETFILTER', 
      desc: 'íŒ¨í‚· í•„í„°ë§ ë° NAT',
      detailedDesc: 'NetfilterëŠ” ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì˜ íŒ¨í‚· í•„í„°ë§ ë° NAT(Network Address Translation) í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. iptablesì™€ nftablesì˜ ê¸°ë°˜ì´ ë˜ëŠ” ì¸í”„ë¼ë¡œ, ì—¬ëŸ¬ hook ì§€ì ì—ì„œ íŒ¨í‚·ì„ ê°€ë¡œì±„ ì²˜ë¦¬í•©ë‹ˆë‹¤. PREROUTING, INPUT, FORWARD, OUTPUT, POSTROUTINGì˜ 5ê°€ì§€ hook ì§€ì ì—ì„œ íŒ¨í‚·ì„ ê²€ì‚¬í•˜ê³ , conntrack(ì—°ê²° ì¶”ì ), NAT, í•„í„°ë§, mangling ë“±ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.',
      functions: ['nf_hook_slow()'], 
      position: { x: 1200, y: -250 } 
    },
    { 
      id: 'routing-rx', 
      label: 'Routing', 
      level: 'ROUTING', 
      desc: 'ë¼ìš°íŒ… í…Œì´ë¸” ì¡°íšŒ',
      detailedDesc: 'ë¼ìš°íŒ… ê²°ì • ë‹¨ê³„ì—ì„œëŠ” FIB(Forwarding Information Base)ë¥¼ ì¡°íšŒí•˜ì—¬ íŒ¨í‚·ì˜ ëª©ì ì§€ê°€ ë¡œì»¬ ì‹œìŠ¤í…œì¸ì§€, ë‹¤ë¥¸ í˜¸ìŠ¤íŠ¸ë¡œ í¬ì›Œë”©í•´ì•¼ í•˜ëŠ”ì§€ ê²°ì •í•©ë‹ˆë‹¤. ip_route_input_noref() í•¨ìˆ˜ê°€ ë¼ìš°íŒ… í…Œì´ë¸”ì„ ì¡°íšŒí•˜ê³ , ê²°ê³¼ì— ë”°ë¼ ë¡œì»¬ ìˆ˜ì‹ (INPUT) ë˜ëŠ” í¬ì›Œë”©(FORWARD) ê²½ë¡œë¡œ ë¶„ê¸°í•©ë‹ˆë‹¤. ë¼ìš°íŒ… ê²°ì • í›„ì—ëŠ” íŒ¨í‚·ì˜ ëª©ì ì§€ ì¸í„°í˜ì´ìŠ¤ì™€ ê²Œì´íŠ¸ì›¨ì´ ì •ë³´ê°€ skbì— ì„¤ì •ë©ë‹ˆë‹¤.',
      functions: ['ip_route_input_noref()', 'ip_rcv_finish()'], 
      position: { x: 1500, y: -250 } 
    },
    { 
      id: 'socket-rx', 
      label: 'Socket', 
      level: 'SOCKET', 
      desc: 'User-space ì „ë‹¬',
      detailedDesc: 'Socketì€ ì»¤ë„ê³¼ ì‚¬ìš©ì ê³µê°„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‚¬ì´ì˜ ì¸í„°í˜ì´ìŠ¤ ì—­í• ì„ í•˜ëŠ” ì¶”ìƒí™” ê³„ì¸µì…ë‹ˆë‹¤. Socket ê³„ì¸µì—ì„œëŠ” L4(ì „ì†¡ ê³„ì¸µ) í”„ë¡œí† ì½œ(TCP/UDP/SCTP ë“±)ì— ë”°ë¼ íŒ¨í‚·ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. TCPì˜ ê²½ìš° tcp_v4_rcv()ì—ì„œ íŒ¨í‚·ì˜ ì‹œí€€ìŠ¤ ë²ˆí˜¸, ì²´í¬ì„¬, ì—°ê²° ìƒíƒœë¥¼ ê²€ì¦í•˜ê³ , ESTABLISHED ìƒíƒœì˜ ì—°ê²°ì— ëŒ€í•´ì„œëŠ” tcp_v4_do_rcv()ë¥¼ í˜¸ì¶œí•˜ì—¬ ì²˜ë¦¬í•©ë‹ˆë‹¤. íŒ¨í‚·ì´ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬ë˜ë©´ sock_queue_rcv_skb()ë¥¼ í†µí•´ í•´ë‹¹ ì†Œì¼“ì˜ ìˆ˜ì‹  í(sk_receive_queue)ì— ì¶”ê°€ë©ë‹ˆë‹¤. íŒ¨í‚·ì´ íì— ì¶”ê°€ë˜ë©´ sk_data_ready() ì½œë°±ì„ í˜¸ì¶œí•˜ì—¬ ëŒ€ê¸° ì¤‘ì¸ ì‚¬ìš©ì ê³µê°„ í”„ë¡œì„¸ìŠ¤ë¥¼ ê¹¨ì›ë‹ˆë‹¤(wakeup). Socketì€ struct socketê³¼ struct sock êµ¬ì¡°ì²´ë¡œ í‘œí˜„ë˜ë©°, ê° ì†Œì¼“ì€ ê³ ìœ í•œ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ì™€ ì—°ê²°ë©ë‹ˆë‹¤. ì‚¬ìš©ì ê³µê°„ì˜ recv(), read(), recvfrom() ë“±ì˜ ì‹œìŠ¤í…œ ì½œì€ ì´ íì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ê°‘ë‹ˆë‹¤. Socketì€ ë˜í•œ í”„ë¡œí† ì½œë³„ íŠ¹ì„±(TCPì˜ ì‹ ë¢°ì„±, ìˆœì„œ ë³´ì¥, íë¦„ ì œì–´, UDPì˜ ë¹„ì—°ê²°ì„± ë“±)ì„ êµ¬í˜„í•©ë‹ˆë‹¤.',
      functions: ['tcp_v4_rcv()', 'tcp_v4_do_rcv()', 'sock_queue_rcv_skb()', 'sk_data_ready()', 'inet_recvmsg()'], 
      position: { x: 1800, y: -250 } 
    },
    { 
      id: 'tcp-rx-buffer', 
      label: 'TCP RX Buffer', 
      level: 'BUFFER', 
      desc: 'TCP ìˆ˜ì‹  ë²„í¼',
      detailedDesc: 'TCP ìˆ˜ì‹  ë²„í¼ëŠ” TCP í”„ë¡œí† ì½œì´ ìˆ˜ì‹ í•œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë²„í¼ì…ë‹ˆë‹¤. ìˆœì„œê°€ ë§ì§€ ì•Šì€ íŒ¨í‚·ì„ ì¬ì •ë ¬í•˜ê±°ë‚˜, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì½ì„ ë•Œê¹Œì§€ ë°ì´í„°ë¥¼ ë³´ê´€í•©ë‹ˆë‹¤. ì´ ë²„í¼ì˜ í¬ê¸°ëŠ” SO_RCVBUF ì†Œì¼“ ì˜µì…˜ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìœ¼ë©°, TCP íë¦„ ì œì–´ì™€ í˜¼ì¡ ì œì–´ì— ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤.',
      functions: ['tcp_rcv_established()', 'tcp_data_queue()'], 
      position: { x: 1800, y: -200 } 
    },
    { 
      id: 'socket-rx-queue', 
      label: 'Socket RX Queue', 
      level: 'BUFFER', 
      desc: 'ì†Œì¼“ ìˆ˜ì‹  í',
      detailedDesc: 'ì†Œì¼“ì˜ ìˆ˜ì‹  í(sk_receive_queue)ëŠ” ì»¤ë„ì—ì„œ ì‚¬ìš©ì ê³µê°„ìœ¼ë¡œ ì „ë‹¬ë  íŒ¨í‚·ì„ ì €ì¥í•˜ëŠ” íì…ë‹ˆë‹¤. TCP/UDP ë“± í”„ë¡œí† ì½œ ê³„ì¸µì—ì„œ ì²˜ë¦¬ëœ íŒ¨í‚·ì´ ì´ íì— ì¶”ê°€ë˜ê³ , ì‚¬ìš©ì ê³µê°„ì˜ recv(), read() ë“±ì˜ ì‹œìŠ¤í…œ ì½œì´ ì´ íì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ê°‘ë‹ˆë‹¤. íê°€ ë¹„ì–´ìˆìœ¼ë©´ í”„ë¡œì„¸ìŠ¤ê°€ ë¸”ë¡œí‚¹ë˜ê³ , ë°ì´í„°ê°€ ë„ì°©í•˜ë©´ wakeup ì‹ í˜¸ë¥¼ ë°›ì•„ ê¹¨ì–´ë‚©ë‹ˆë‹¤.',
      functions: ['sock_queue_rcv_skb()', 'skb_queue_tail()', 'sk_data_ready()'], 
      position: { x: 1950, y: -250 } 
    },
    { 
      id: 'user-rx', 
      label: 'User Application', 
      level: 'USER', 
      desc: 'ì‚¬ìš©ì ê³µê°„ ì• í”Œë¦¬ì¼€ì´ì…˜ (RX)',
      detailedDesc: 'ì‚¬ìš©ì ê³µê°„ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ recv(), read(), recvfrom() ë“±ì˜ ì‹œìŠ¤í…œ ì½œì„ í˜¸ì¶œí•˜ì—¬ ì†Œì¼“ì—ì„œ ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•©ë‹ˆë‹¤. ì»¤ë„ì˜ ì†Œì¼“ ìˆ˜ì‹  íì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë²„í¼ë¡œ ë³µì‚¬í•©ë‹ˆë‹¤. íê°€ ë¹„ì–´ìˆìœ¼ë©´ í”„ë¡œì„¸ìŠ¤ê°€ ë¸”ë¡œí‚¹ë˜ê³ , ë°ì´í„°ê°€ ë„ì°©í•˜ë©´ wakeup ì‹ í˜¸ë¥¼ ë°›ì•„ ê¹¨ì–´ë‚˜ ë°ì´í„°ë¥¼ ì½ì–´ê°‘ë‹ˆë‹¤.',
      functions: ['recv()', 'read()', 'recvfrom()'], 
      position: { x: 2100, y: -250 } 
    },
    
    // Netfilter Hook ì„¸ë¶€
    { 
      id: 'nf:prerouting', 
      label: 'PREROUTING', 
      level: 'NETFILTER', 
      desc: 'ë¼ìš°íŒ… ì „ ì²˜ë¦¬',
      detailedDesc: 'PREROUTING hookì€ ë¼ìš°íŒ… ê²°ì • ì´ì „ì— ì‹¤í–‰ë˜ëŠ” ì²« ë²ˆì§¸ Netfilter hookì…ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì£¼ë¡œ DNAT(Destination NAT)ì™€ conntrack(ì—°ê²° ì¶”ì )ì´ ì‹œì‘ë©ë‹ˆë‹¤. íŒ¨í‚·ì˜ ëª©ì ì§€ ì£¼ì†Œë¥¼ ë³€ê²½í•˜ê±°ë‚˜, ì—°ê²° ì¶”ì  í…Œì´ë¸”ì— ì—°ê²° ì •ë³´ë¥¼ ê¸°ë¡í•©ë‹ˆë‹¤. ì´ hookì€ ëª¨ë“  ë“¤ì–´ì˜¤ëŠ” íŒ¨í‚·ì— ëŒ€í•´ ì‹¤í–‰ë˜ë©°, NF_INET_PRE_ROUTING hook pointì—ì„œ ì²˜ë¦¬ë©ë‹ˆë‹¤.',
      functions: ['nf_hook_slow()', 'ipv4_conntrack_in()'], 
      parent: 'netfilter-rx', 
      position: { x: 1200, y: -350 } 
    },
    { 
      id: 'nf:input', 
      label: 'INPUT', 
      level: 'NETFILTER', 
      desc: 'ë¡œì»¬ ëª©ì ì§€ ì²˜ë¦¬',
      detailedDesc: 'INPUT hookì€ ë¡œì»¬ ì‹œìŠ¤í…œìœ¼ë¡œ í–¥í•˜ëŠ” íŒ¨í‚·ì— ëŒ€í•´ì„œë§Œ ì‹¤í–‰ë©ë‹ˆë‹¤. ë¼ìš°íŒ… ê²°ì • í›„ íŒ¨í‚·ì˜ ëª©ì ì§€ê°€ ë¡œì»¬ì¸ ê²½ìš°, ì´ hookì—ì„œ íŒ¨í‚· í•„í„°ë§ ê·œì¹™ì„ ì ìš©í•©ë‹ˆë‹¤. ë°©í™”ë²½ ê·œì¹™, ë¡œê¹…, íŒ¨í‚· ë“œë¡­ ë“±ì˜ ì‘ì—…ì´ ì—¬ê¸°ì„œ ìˆ˜í–‰ë©ë‹ˆë‹¤. NF_INET_LOCAL_IN hook pointì—ì„œ ì²˜ë¦¬ë˜ë©°, ip_local_deliver() í•¨ìˆ˜ê°€ ì´ hookì„ í˜¸ì¶œí•©ë‹ˆë‹¤.',
      functions: ['ip_local_deliver()', 'nf_hook()'], 
      parent: 'netfilter-rx', 
      position: { x: 1350, y: -350 } 
    },
    { 
      id: 'nf:forward', 
      label: 'FORWARD', 
      level: 'NETFILTER', 
      desc: 'í¬ì›Œë”© ì²˜ë¦¬',
      detailedDesc: 'FORWARD hookì€ ë¼ìš°í„° ì—­í• ì„ í•˜ëŠ” ì‹œìŠ¤í…œì—ì„œ, í•œ ì¸í„°í˜ì´ìŠ¤ë¡œ ë“¤ì–´ì˜¨ íŒ¨í‚·ì„ ë‹¤ë¥¸ ì¸í„°í˜ì´ìŠ¤ë¡œ ì „ë‹¬í•  ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤. ë¡œì»¬ ì‹œìŠ¤í…œì´ ëª©ì ì§€ê°€ ì•„ë‹Œ íŒ¨í‚·ì— ëŒ€í•´ í¬ì›Œë”© ê·œì¹™ì„ ì ìš©í•©ë‹ˆë‹¤. ì´ hookì—ì„œë„ íŒ¨í‚· í•„í„°ë§, ë¡œê¹… ë“±ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤. NF_INET_FORWARD hook pointì—ì„œ ì²˜ë¦¬ë˜ë©°, ip_forward() í•¨ìˆ˜ê°€ ì´ hookì„ í˜¸ì¶œí•©ë‹ˆë‹¤.',
      functions: ['ip_forward()', 'nf_hook()'], 
      parent: 'netfilter-rx', 
      position: { x: 1200, y: -150 } 
    },
    
    // TX ê²½ë¡œ
    { 
      id: 'user-tx', 
      label: 'User Application', 
      level: 'USER', 
      desc: 'ì‚¬ìš©ì ê³µê°„ ì• í”Œë¦¬ì¼€ì´ì…˜ (TX)',
      detailedDesc: 'ì‚¬ìš©ì ê³µê°„ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ send(), sendto(), write() ë“±ì˜ ì‹œìŠ¤í…œ ì½œì„ í˜¸ì¶œí•˜ì—¬ ë„¤íŠ¸ì›Œí¬ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ë²„í¼ì˜ ë°ì´í„°ê°€ ì»¤ë„ ê³µê°„ìœ¼ë¡œ ë³µì‚¬ë˜ê³ , ì†Œì¼“ì˜ ì†¡ì‹  íì— ì¶”ê°€ë©ë‹ˆë‹¤. íê°€ ê°€ë“ ì°¨ë©´ í”„ë¡œì„¸ìŠ¤ê°€ ë¸”ë¡œí‚¹ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
      functions: ['send()', 'sendto()', 'write()'], 
      position: { x: -300, y: 250 } 
    },
    { 
      id: 'socket-tx-queue', 
      label: 'Socket TX Queue', 
      level: 'BUFFER', 
      desc: 'ì†Œì¼“ ì†¡ì‹  í',
      detailedDesc: 'ì†Œì¼“ì˜ ì†¡ì‹  í(sk_write_queue)ëŠ” ì‚¬ìš©ì ê³µê°„ì—ì„œ ì „ì†¡ ìš”ì²­ëœ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” íì…ë‹ˆë‹¤. send(), sendto() ë“±ì˜ ì‹œìŠ¤í…œ ì½œë¡œ ì „ë‹¬ëœ ë°ì´í„°ê°€ ì´ íì— ì¶”ê°€ë˜ê³ , TCP/IP ê³„ì¸µì—ì„œ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤. íê°€ ê°€ë“ ì°¨ë©´ í”„ë¡œì„¸ìŠ¤ê°€ ë¸”ë¡œí‚¹ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
      functions: ['sock_alloc_send_skb()', 'skb_queue_tail()'], 
      position: { x: -150, y: 250 } 
    },
    { 
      id: 'socket-tx', 
      label: 'Socket', 
      level: 'SOCKET', 
      desc: 'User-spaceì—ì„œ ì „ì†¡',
      detailedDesc: 'Socketì€ ì‚¬ìš©ì ê³µê°„ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ì»¤ë„ ë„¤íŠ¸ì›Œí¬ ìŠ¤íƒ ì‚¬ì´ì˜ ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤. ì‚¬ìš©ì ê³µê°„ì—ì„œ send(), sendto(), write() ë“±ì˜ ì‹œìŠ¤í…œ ì½œì„ í˜¸ì¶œí•˜ë©´, ì»¤ë„ì˜ syscall í•¸ë“¤ëŸ¬(__sys_sendto(), __sys_sendmsg() ë“±)ê°€ í˜¸ì¶œë©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ë“¤ì€ sock_sendmsg()ë¥¼ í†µí•´ ì†Œì¼“ì— ë°ì´í„°ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤. ì´ ì‹œì ì—ì„œ ì‚¬ìš©ì ê³µê°„ì˜ ë°ì´í„° ë²„í¼ê°€ ì»¤ë„ ê³µê°„ìœ¼ë¡œ ë³µì‚¬ë˜ê³ (ë˜ëŠ” zero-copy ê¸°ë²• ì‚¬ìš© ì‹œ í˜ì´ì§€ ì°¸ì¡°ë§Œ ì „ë‹¬), ì†Œì¼“ì˜ ì „ì†¡ í(sk_write_queue)ì— ì¶”ê°€ë©ë‹ˆë‹¤. Socketì€ í”„ë¡œí† ì½œë³„ íŠ¹ì„±ì„ êµ¬í˜„í•©ë‹ˆë‹¤: TCPì˜ ê²½ìš° tcp_sendmsg()ì—ì„œ ì„¸ê·¸ë¨¼íŠ¸ ë¶„í• , ì‹œí€€ìŠ¤ ë²ˆí˜¸ í• ë‹¹, íë¦„ ì œì–´ ë° í˜¼ì¡ ì œì–´ë¥¼ ìˆ˜í–‰í•˜ê³ , UDPì˜ ê²½ìš° udp_sendmsg()ì—ì„œ ë‹¨ìˆœíˆ UDP í—¤ë”ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. Socketì€ ë˜í•œ ì†Œì¼“ ì˜µì…˜(SO_SNDBUF, SO_RCVBUF, SO_REUSEADDR ë“±)ì„ ê´€ë¦¬í•˜ê³ , ë…¼ë¸”ë¡œí‚¹ ëª¨ë“œ, íƒ€ì„ì•„ì›ƒ, ì—ëŸ¬ ì²˜ë¦¬ ë“±ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤. Socketì€ struct socketê³¼ struct sock êµ¬ì¡°ì²´ë¡œ í‘œí˜„ë˜ë©°, íŒŒì¼ ì‹œìŠ¤í…œê³¼ í†µí•©ë˜ì–´ íŒŒì¼ ë””ìŠ¤í¬ë¦½í„°ë¥¼ í†µí•´ ì ‘ê·¼ë©ë‹ˆë‹¤.',
      functions: ['__sys_sendto()', '__sys_sendmsg()', 'sock_sendmsg()', 'inet_sendmsg()', 'tcp_sendmsg()', 'udp_sendmsg()'], 
      position: { x: 0, y: 250 } 
    },
    { 
      id: 'tcp-tx', 
      label: 'TCP/IP', 
      level: 'SOCKET', 
      desc: 'TCP/IP ì²˜ë¦¬',
      detailedDesc: 'TCP ê³„ì¸µì—ì„œëŠ” tcp_sendmsg()ê°€ í˜¸ì¶œë˜ì–´ ë°ì´í„°ë¥¼ TCP ì„¸ê·¸ë¨¼íŠ¸ë¡œ ë¶„í• í•©ë‹ˆë‹¤. TCP í—¤ë”ë¥¼ ì¶”ê°€í•˜ê³ , íë¦„ ì œì–´, í˜¼ì¡ ì œì–´ ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©í•©ë‹ˆë‹¤. ê·¸ í›„ IP ê³„ì¸µìœ¼ë¡œ ì „ë‹¬í•˜ê¸° ìœ„í•´ ip_queue_xmit()ì„ í˜¸ì¶œí•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ IP í—¤ë”ê°€ ì¶”ê°€ë˜ê³ , í•„ìš”ì‹œ IP fragmentationì´ ìˆ˜í–‰ë©ë‹ˆë‹¤.',
      functions: ['tcp_sendmsg()', 'tcp_push()', 'ip_queue_xmit()'], 
      position: { x: 300, y: 250 } 
    },
    { 
      id: 'tcp-tx-buffer', 
      label: 'TCP TX Buffer', 
      level: 'BUFFER', 
      desc: 'TCP ì†¡ì‹  ë²„í¼',
      detailedDesc: 'TCP ì†¡ì‹  ë²„í¼ëŠ” TCP í”„ë¡œí† ì½œì´ ì „ì†¡í•  ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë²„í¼ì…ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì „ì†¡ ìš”ì²­í•œ ë°ì´í„°ê°€ ì´ ë²„í¼ì— ì €ì¥ë˜ê³ , TCP íë¦„ ì œì–´ì™€ í˜¼ì¡ ì œì–´ ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¼ ì„¸ê·¸ë¨¼íŠ¸ë¡œ ë¶„í• ë˜ì–´ ì „ì†¡ë©ë‹ˆë‹¤. ì´ ë²„í¼ì˜ í¬ê¸°ëŠ” SO_SNDBUF ì†Œì¼“ ì˜µì…˜ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìœ¼ë©°, ë²„í¼ê°€ ê°€ë“ ì°¨ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë¸”ë¡œí‚¹ë©ë‹ˆë‹¤.',
      functions: ['tcp_sendmsg()', 'tcp_write_xmit()'], 
      position: { x: 300, y: 300 } 
    },
    { 
      id: 'netfilter-tx-out', 
      label: 'Netfilter OUTPUT', 
      level: 'NETFILTER', 
      desc: 'ì¶œë ¥ ì „ í•„í„°ë§',
      detailedDesc: 'OUTPUT hookì€ ë¡œì»¬ ì‹œìŠ¤í…œì—ì„œ ìƒì„±ëœ íŒ¨í‚·ì´ ë„¤íŠ¸ì›Œí¬ë¡œ ë‚˜ê°€ê¸° ì „ì— ì‹¤í–‰ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ SNAT(Source NAT)ì˜ ì¼ë¶€ì™€ ë°©í™”ë²½ ê·œì¹™ì´ ì ìš©ë©ë‹ˆë‹¤. ë¡œì»¬ì—ì„œ ìƒì„±ëœ íŒ¨í‚·ì— ëŒ€í•œ í•„í„°ë§ê³¼ NAT ë³€í™˜ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤. NF_INET_LOCAL_OUT hook pointì—ì„œ ì²˜ë¦¬ë˜ë©°, ip_local_out() í•¨ìˆ˜ê°€ ì´ hookì„ í˜¸ì¶œí•©ë‹ˆë‹¤.',
      functions: ['nf_hook()', 'ipv4_conntrack_local()', 'ip_local_out()'], 
      position: { x: 600, y: 250 } 
    },
    { 
      id: 'routing-tx', 
      label: 'Routing', 
      level: 'ROUTING', 
      desc: 'ì¶œë ¥ ë¼ìš°íŒ…',
      detailedDesc: 'ì¶œë ¥ ë¼ìš°íŒ…ì—ì„œëŠ” ip_route_output_flow() í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì–´ íŒ¨í‚·ì˜ ëª©ì ì§€ì— ëŒ€í•œ ìµœì ì˜ ê²½ë¡œë¥¼ ê²°ì •í•©ë‹ˆë‹¤. ë¼ìš°íŒ… í…Œì´ë¸”ì„ ì¡°íšŒí•˜ì—¬ ë‹¤ìŒ í™‰(next hop) ì£¼ì†Œì™€ ì¶œë ¥ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê²°ì •í•©ë‹ˆë‹¤. ì´ ì •ë³´ëŠ” skbì— ì €ì¥ë˜ì–´ ì´í›„ ë‹¨ê³„ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤.',
      functions: ['ip_route_output_flow()'], 
      position: { x: 900, y: 250 } 
    },
    { 
      id: 'netfilter-tx-post', 
      label: 'Netfilter POSTROUTING', 
      level: 'NETFILTER', 
      desc: 'ë¼ìš°íŒ… í›„ ì²˜ë¦¬',
      detailedDesc: 'POSTROUTING hookì€ ë¼ìš°íŒ… ê²°ì • í›„, íŒ¨í‚·ì´ ì‹¤ì œë¡œ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¡œ ì „ì†¡ë˜ê¸° ì§ì „ì— ì‹¤í–‰ë˜ëŠ” ë§ˆì§€ë§‰ Netfilter hookì…ë‹ˆë‹¤. ì—¬ê¸°ì„œ SNAT(Source NAT)ì˜ ìµœì¢… ë‹¨ê³„ê°€ ìˆ˜í–‰ë˜ê³ , íŒ¨í‚·ì˜ ì†ŒìŠ¤ ì£¼ì†Œê°€ ë³€ê²½ë©ë‹ˆë‹¤. ë˜í•œ ë§ˆì§€ë§‰ ë°©í™”ë²½ ì²´í¬ì™€ íŒ¨í‚· manglingì´ ìˆ˜í–‰ë©ë‹ˆë‹¤. NF_INET_POST_ROUTING hook pointì—ì„œ ì²˜ë¦¬ë©ë‹ˆë‹¤.',
      functions: ['nf_hook()', 'ip_finish_output()'], 
      position: { x: 1200, y: 250 } 
    },
    { 
      id: 'tc-tx', 
      label: 'qdisc / TC', 
      level: 'TC', 
      desc: 'íŠ¸ë˜í”½ ì œì–´',
      detailedDesc: 'qdisc(Queueing Discipline)ì™€ TC(Traffic Control)ëŠ” íŒ¨í‚· ì „ì†¡ì„ ì œì–´í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. dev_queue_xmit() í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë©´, ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì— ì—°ê²°ëœ qdiscê°€ íŒ¨í‚·ì„ íì— ì¶”ê°€í•˜ê±°ë‚˜ ì¦‰ì‹œ ì „ì†¡í•©ë‹ˆë‹¤. ë‹¤ì–‘í•œ qdisc ì•Œê³ ë¦¬ì¦˜(fq, cake, pfifo_fast ë“±)ì´ ì‚¬ìš©ë  ìˆ˜ ìˆìœ¼ë©°, íŠ¸ë˜í”½ shaping(ëŒ€ì—­í­ ì œí•œ), policing(íŠ¸ë˜í”½ ì œí•œ), ìŠ¤ì¼€ì¤„ë§ ë“±ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. eBPF TC hookë„ ì—¬ê¸°ì„œ ì‹¤í–‰ë˜ì–´ ì»¤ìŠ¤í…€ íŒ¨í‚· ì²˜ë¦¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.',
      functions: ['dev_queue_xmit()', 'qdisc_run()', 'tc_classify()'], 
      position: { x: 1500, y: 250 } 
    },
    { 
      id: 'qdisc-queue', 
      label: 'qdisc Queue', 
      level: 'BUFFER', 
      desc: 'qdisc í',
      detailedDesc: 'qdisc íëŠ” íŠ¸ë˜í”½ ì œì–´ë¥¼ ìœ„í•´ íŒ¨í‚·ì„ ì„ì‹œë¡œ ì €ì¥í•˜ëŠ” íì…ë‹ˆë‹¤. dev_queue_xmit()ì—ì„œ íŒ¨í‚·ì´ ë„ì°©í•˜ë©´, ì„¤ì •ëœ qdisc ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¼ íŒ¨í‚·ì´ íì— ì¶”ê°€ë˜ê±°ë‚˜ ì¦‰ì‹œ ì „ì†¡ë©ë‹ˆë‹¤. íì˜ í¬ê¸°ì™€ ë™ì‘ ë°©ì‹ì€ qdisc íƒ€ì…ì— ë”°ë¼ ë‹¤ë¦…ë‹ˆë‹¤. pfifo_fastëŠ” ë‹¨ìˆœ FIFO, fqëŠ” ê³µì • íì‰, cakeëŠ” ê³ ê¸‰ íŠ¸ë˜í”½ ì œì–´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. íê°€ ê°€ë“ ì°¨ë©´ íŒ¨í‚·ì´ ë“œë¡­ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
      functions: ['qdisc_enqueue()', 'qdisc_dequeue()', 'qdisc_run()'], 
      position: { x: 1500, y: 300 } 
    },
    { 
      id: 'driver-tx', 
      label: 'Driver', 
      level: 'DRIVER', 
      desc: 'ë“œë¼ì´ë²„ ì „ì†¡',
      detailedDesc: 'ë“œë¼ì´ë²„ì˜ ndo_start_xmit() í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì–´ íŒ¨í‚·ì„ NIC í•˜ë“œì›¨ì–´ë¡œ ì „ì†¡í•©ë‹ˆë‹¤. ë“œë¼ì´ë²„ëŠ” íŒ¨í‚·ì„ í•˜ë“œì›¨ì–´ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” í˜•íƒœë¡œ ë³€í™˜í•˜ê³ , DMAë¥¼ í†µí•´ NICì˜ ì „ì†¡ ë²„í¼ì— íŒ¨í‚·ì„ ë³µì‚¬í•©ë‹ˆë‹¤. ì „ì†¡ ì™„ë£Œ í›„ì—ëŠ” í•˜ë“œì›¨ì–´ ì¸í„°ëŸ½íŠ¸ë¥¼ í†µí•´ ì»¤ë„ì— ì•Œë¦½ë‹ˆë‹¤.',
      functions: ['ndo_start_xmit()', 'netdev_start_xmit()'], 
      position: { x: 1800, y: 250 } 
    },
    { 
      id: 'nic-tx-ring', 
      label: 'NIC TX Ring', 
      level: 'BUFFER', 
      desc: 'NIC ì†¡ì‹  ë§ ë²„í¼',
      detailedDesc: 'NIC í•˜ë“œì›¨ì–´ì˜ ì „ì†¡ ë§ ë²„í¼ëŠ” ë“œë¼ì´ë²„ê°€ ì „ì†¡í•  íŒ¨í‚·ì„ ì €ì¥í•˜ëŠ” í•˜ë“œì›¨ì–´ ë²„í¼ì…ë‹ˆë‹¤. ë“œë¼ì´ë²„ê°€ íŒ¨í‚·ì„ ì´ ë²„í¼ì— DMAë¡œ ë³µì‚¬í•˜ë©´, NIC í•˜ë“œì›¨ì–´ê°€ ìë™ìœ¼ë¡œ íŒ¨í‚·ì„ ë„¤íŠ¸ì›Œí¬ ì¼€ì´ë¸”ë¡œ ì „ì†¡í•©ë‹ˆë‹¤. ë§ ë²„í¼ëŠ” ìˆœí™˜ êµ¬ì¡°ë¡œ ë˜ì–´ ìˆì–´ ì—°ì†ì ì¸ íŒ¨í‚· ì „ì†¡ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì „ì†¡ ì™„ë£Œ í›„ í•˜ë“œì›¨ì–´ ì¸í„°ëŸ½íŠ¸ë¥¼ í†µí•´ ë“œë¼ì´ë²„ì— ì•Œë¦½ë‹ˆë‹¤.',
      functions: ['DMA', 'ring buffer descriptor'], 
      position: { x: 1950, y: 300 } 
    },
    { 
      id: 'nic-tx', 
      label: 'NIC', 
      level: 'HARDWARE', 
      desc: 'ë„¤íŠ¸ì›Œí¬ ì¹´ë“œë¡œ ì „ì†¡',
      detailedDesc: 'NIC í•˜ë“œì›¨ì–´ëŠ” DMAë¥¼ í†µí•´ ì»¤ë„ ë©”ëª¨ë¦¬ì—ì„œ íŒ¨í‚· ë°ì´í„°ë¥¼ ì½ì–´ì™€ ë¬¼ë¦¬ì  ë„¤íŠ¸ì›Œí¬ ì¼€ì´ë¸”ë¡œ ì „ì†¡í•©ë‹ˆë‹¤. ì´ëŠ” í•˜ë“œì›¨ì–´ ë ˆë²¨ì—ì„œ ìˆ˜í–‰ë˜ë©°, ì»¤ë„ì˜ ê°œì… ì—†ì´ ì§ì ‘ ë©”ëª¨ë¦¬ì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ ì „ì†¡í•©ë‹ˆë‹¤. ì „ì†¡ ì™„ë£Œ í›„ í•˜ë“œì›¨ì–´ ì¸í„°ëŸ½íŠ¸ë¥¼ ë°œìƒì‹œì¼œ ì»¤ë„ì— ì•Œë¦½ë‹ˆë‹¤.',
      functions: ['DMA'], 
      position: { x: 2100, y: 250 } 
    },
    
    // Netfilter TX Hook ì„¸ë¶€
    { 
      id: 'nf:output', 
      label: 'OUTPUT', 
      level: 'NETFILTER', 
      desc: 'ë¡œì»¬ ìƒì„± íŒ¨í‚· ì²˜ë¦¬',
      detailedDesc: 'OUTPUT hookì€ ë¡œì»¬ ì‹œìŠ¤í…œì—ì„œ ìƒì„±ëœ íŒ¨í‚·ì— ëŒ€í•´ ì‹¤í–‰ë©ë‹ˆë‹¤. ë¼ìš°íŒ… ê²°ì • ì „ì— ì‹¤í–‰ë˜ë©°, ë¡œì»¬ì—ì„œ ìƒì„±ëœ íŒ¨í‚·ì— ëŒ€í•œ í•„í„°ë§ê³¼ NATë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤. SNATì˜ ì´ˆê¸° ë‹¨ê³„ê°€ ì—¬ê¸°ì„œ ìˆ˜í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
      functions: ['ip_local_out()'], 
      parent: 'netfilter-tx-out', 
      position: { x: 600, y: 350 } 
    },
    { 
      id: 'nf:postrouting', 
      label: 'POSTROUTING', 
      level: 'NETFILTER', 
      desc: 'ë¼ìš°íŒ… í›„ ìµœì¢… ì²˜ë¦¬',
      detailedDesc: 'POSTROUTING hookì€ ë¼ìš°íŒ… ê²°ì • í›„, íŒ¨í‚·ì´ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¡œ ë‚˜ê°€ê¸° ì§ì „ì— ì‹¤í–‰ë˜ëŠ” ë§ˆì§€ë§‰ hookì…ë‹ˆë‹¤. SNATì˜ ìµœì¢… ë‹¨ê³„ê°€ ì—¬ê¸°ì„œ ìˆ˜í–‰ë˜ë©°, íŒ¨í‚·ì˜ ì†ŒìŠ¤ ì£¼ì†Œê°€ ë³€ê²½ë©ë‹ˆë‹¤. ë˜í•œ ë§ˆì§€ë§‰ ë°©í™”ë²½ ì²´í¬ì™€ íŒ¨í‚· manglingì´ ìˆ˜í–‰ë©ë‹ˆë‹¤.',
      functions: ['ip_finish_output()'], 
      parent: 'netfilter-tx-post', 
      position: { x: 1200, y: 350 } 
    },
    
    // ì»¤ë„ ì˜µì…˜ ë…¸ë“œ (RXì™€ TX ì‚¬ì´ì— ë°°ì¹˜)
    { 
      id: 'opt-net', 
      label: 'CONFIG_NET', 
      level: 'KERNEL_OPTION', 
      desc: 'ë„¤íŠ¸ì›Œí¬ ì§€ì›',
      detailedDesc: 'ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì˜ ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ì§€ì›ì„ í™œì„±í™”í•©ë‹ˆë‹¤. ì´ ì˜µì…˜ì´ ë¹„í™œì„±í™”ë˜ë©´ ë„¤íŠ¸ì›Œí¬ ê¸°ëŠ¥ì´ ì™„ì „íˆ ì œê±°ë©ë‹ˆë‹¤. ëª¨ë“  ë„¤íŠ¸ì›Œí¬ ê´€ë ¨ ê¸°ëŠ¥ì˜ ê¸°ë³¸ ì „ì œ ì¡°ê±´ì…ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.core.* (ëª¨ë“  ë„¤íŠ¸ì›Œí¬ ê´€ë ¨ sysctlì˜ ê¸°ë°˜)\nì£¼ìš” sysctl ë° Ubuntu 24.04 ê¸°ë³¸ê°’:\n- net.core.rmem_default = 212992 (ìˆ˜ì‹  ë²„í¼ ê¸°ë³¸ í¬ê¸°)\n- net.core.wmem_default = 212992 (ì†¡ì‹  ë²„í¼ ê¸°ë³¸ í¬ê¸°)\n- net.core.rmem_max = 212992 (ìˆ˜ì‹  ë²„í¼ ìµœëŒ€ í¬ê¸°)\n- net.core.wmem_max = 212992 (ì†¡ì‹  ë²„í¼ ìµœëŒ€ í¬ê¸°)\n- net.core.netdev_max_backlog = 1000 (ë„¤íŠ¸ì›Œí¬ ì¥ì¹˜ ë°±ë¡œê·¸ ìµœëŒ€ê°’)',
      functions: [], 
      position: { x: 200, y: -50 } 
    },
    { 
      id: 'opt-inet', 
      label: 'CONFIG_INET', 
      level: 'KERNEL_OPTION', 
      desc: 'TCP/IP ì§€ì›',
      detailedDesc: 'TCP/IP í”„ë¡œí† ì½œ ìŠ¤íƒì„ í™œì„±í™”í•©ë‹ˆë‹¤. IPv4 ë„¤íŠ¸ì›Œí‚¹, TCP, UDP, ICMP ë“±ì˜ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ë ¤ë©´ í•„ìˆ˜ì…ë‹ˆë‹¤. ì´ ì˜µì…˜ì´ ì—†ìœ¼ë©´ IP ê¸°ë°˜ ë„¤íŠ¸ì›Œí‚¹ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.ipv4.*\nì£¼ìš” sysctl ë° Ubuntu 24.04 ê¸°ë³¸ê°’:\n- net.ipv4.ip_forward = 0 (IP í¬ì›Œë”© ë¹„í™œì„±í™”)\n- net.ipv4.tcp_rmem = 4096 131072 6291456 (TCP ìˆ˜ì‹  ë²„í¼: min default max)\n- net.ipv4.tcp_wmem = 4096 16384 4194304 (TCP ì†¡ì‹  ë²„í¼: min default max)\n- net.ipv4.tcp_congestion_control = cubic (TCP í˜¼ì¡ ì œì–´ ì•Œê³ ë¦¬ì¦˜)\n- net.ipv4.tcp_syncookies = 1 (SYN flood ë°©ì–´ í™œì„±í™”)\n- net.ipv4.conf.all.forwarding = 0 (ëª¨ë“  ì¸í„°í˜ì´ìŠ¤ í¬ì›Œë”© ë¹„í™œì„±í™”)',
      functions: [], 
      position: { x: 400, y: -50 } 
    },
    { 
      id: 'opt-ipv6', 
      label: 'CONFIG_IPV6', 
      level: 'KERNEL_OPTION', 
      desc: 'IPv6 ì§€ì›',
      detailedDesc: 'IPv6 í”„ë¡œí† ì½œ ìŠ¤íƒì„ í™œì„±í™”í•©ë‹ˆë‹¤. IPv6 ì£¼ì†Œ, ë¼ìš°íŒ…, Neighbor Discovery ë“±ì„ ì§€ì›í•©ë‹ˆë‹¤. IPv6 ë„¤íŠ¸ì›Œí‚¹ì„ ì‚¬ìš©í•˜ë ¤ë©´ í•„ìˆ˜ì…ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.ipv6.*\nì£¼ìš” sysctl ë° Ubuntu 24.04 ê¸°ë³¸ê°’:\n- net.ipv6.conf.all.forwarding = 0 (IPv6 í¬ì›Œë”© ë¹„í™œì„±í™”)\n- net.ipv6.conf.all.disable_ipv6 = 0 (IPv6 í™œì„±í™”)\n- net.ipv6.conf.default.disable_ipv6 = 0 (ê¸°ë³¸ ì¸í„°í˜ì´ìŠ¤ IPv6 í™œì„±í™”)\n- net.ipv6.ip_nonlocal_bind = 0 (ë¹„ë¡œì»¬ ë°”ì¸ë”© ë¹„í™œì„±í™”)\n- net.ipv6.conf.all.accept_ra = 1 (Router Advertisement ìˆ˜ì‹  í—ˆìš©)',
      functions: [], 
      position: { x: 600, y: -50 } 
    },
    { 
      id: 'opt-netfilter', 
      label: 'CONFIG_NETFILTER', 
      level: 'KERNEL_OPTION', 
      desc: 'Netfilter í”„ë ˆì„ì›Œí¬',
      detailedDesc: 'Netfilter í”„ë ˆì„ì›Œí¬ë¥¼ í™œì„±í™”í•©ë‹ˆë‹¤. iptables, nftables, íŒ¨í‚· í•„í„°ë§, NAT ë“±ì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ í•„ìˆ˜ì…ë‹ˆë‹¤. ë°©í™”ë²½ê³¼ NAT ê¸°ëŠ¥ì˜ ê¸°ë°˜ì´ ë©ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.netfilter.*\nì£¼ìš” sysctl ë° Ubuntu 24.04 ê¸°ë³¸ê°’:\n- net.netfilter.nf_log_all_netns = 0 (ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë¡œê¹… ë¹„í™œì„±í™”)\n- net.netfilter.nf_conntrack_max = 262144 (ì—°ê²° ì¶”ì  ìµœëŒ€ê°’, CONNTRACK í™œì„±í™” ì‹œ)\n- net.netfilter.nf_conntrack_tcp_timeout_established = 432000 (TCP ESTABLISHED íƒ€ì„ì•„ì›ƒ, ì´ˆ)',
      functions: [], 
      position: { x: 800, y: -50 } 
    },
    { 
      id: 'opt-nf-conntrack', 
      label: 'CONFIG_NF_CONNTRACK', 
      level: 'KERNEL_OPTION', 
      desc: 'ì—°ê²° ì¶”ì ',
      detailedDesc: 'Netfilter ì—°ê²° ì¶”ì (Connection Tracking) ê¸°ëŠ¥ì„ í™œì„±í™”í•©ë‹ˆë‹¤. ìƒíƒœ ê¸°ë°˜ ë°©í™”ë²½, NATì˜ ì—°ê²° ì¶”ì  ë“±ì„ ì§€ì›í•©ë‹ˆë‹¤. iptablesì˜ -m state, -m conntrack ëª¨ë“ˆì´ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.netfilter.nf_conntrack.*\nì£¼ìš” sysctl ë° Ubuntu 24.04 ê¸°ë³¸ê°’:\n- net.netfilter.nf_conntrack_max = 262144 (ìµœëŒ€ ì—°ê²° ì¶”ì  ìˆ˜)\n- net.netfilter.nf_conntrack_tcp_timeout_established = 432000 (TCP ESTABLISHED íƒ€ì„ì•„ì›ƒ, ì´ˆ)\n- net.netfilter.nf_conntrack_tcp_timeout_time_wait = 120 (TCP TIME_WAIT íƒ€ì„ì•„ì›ƒ, ì´ˆ)\n- net.netfilter.nf_conntrack_tcp_timeout_close_wait = 60 (TCP CLOSE_WAIT íƒ€ì„ì•„ì›ƒ, ì´ˆ)\n- net.netfilter.nf_conntrack_tcp_timeout_fin_wait = 120 (TCP FIN_WAIT íƒ€ì„ì•„ì›ƒ, ì´ˆ)',
      functions: [], 
      position: { x: 1000, y: -50 } 
    },
    { 
      id: 'opt-nf-nat', 
      label: 'CONFIG_NF_NAT', 
      level: 'KERNEL_OPTION', 
      desc: 'NAT ì§€ì›',
      detailedDesc: 'Netfilter NAT(Network Address Translation) ê¸°ëŠ¥ì„ í™œì„±í™”í•©ë‹ˆë‹¤. SNAT, DNAT, MASQUERADE ë“±ì˜ NAT ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ í•„ìˆ˜ì…ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.netfilter.nf_nat.*, net.ipv4.ip_forward\nì£¼ìš” sysctl ë° Ubuntu 24.04 ê¸°ë³¸ê°’:\n- net.netfilter.nf_nat_max = 262144 (NAT ìµœëŒ€ ì—°ê²° ìˆ˜)\n- net.ipv4.ip_forward = 0 (IP í¬ì›Œë”© ë¹„í™œì„±í™”, NAT ì‚¬ìš© ì‹œ 1ë¡œ ì„¤ì • í•„ìš”)\n- net.ipv4.conf.all.forwarding = 0 (ëª¨ë“  ì¸í„°í˜ì´ìŠ¤ í¬ì›Œë”© ë¹„í™œì„±í™”)\n- net.ipv4.conf.default.forwarding = 0 (ê¸°ë³¸ í¬ì›Œë”© ë¹„í™œì„±í™”)',
      functions: [], 
      position: { x: 1200, y: -50 } 
    },
    { 
      id: 'opt-xdp', 
      label: 'CONFIG_XDP_SOCKETS', 
      level: 'KERNEL_OPTION', 
      desc: 'XDP ì†Œì¼“',
      detailedDesc: 'XDP(eXpress Data Path) ì†Œì¼“ ì§€ì›ì„ í™œì„±í™”í•©ë‹ˆë‹¤. XDP í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ì—¬ ë“œë¼ì´ë²„ ë ˆë²¨ì—ì„œ ê³ ì† íŒ¨í‚· ì²˜ë¦¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: ì—†ìŒ (ì»´íŒŒì¼ íƒ€ì„ ì˜µì…˜)\nì°¸ê³ : XDPëŠ” ì£¼ë¡œ eBPF í”„ë¡œê·¸ë¨ì„ í†µí•´ ì œì–´ë˜ë©°, sysctlë¡œ ì§ì ‘ ì œì–´ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. XDP í”„ë¡œê·¸ë¨ì€ bpf() ì‹œìŠ¤í…œ ì½œì„ í†µí•´ ë¡œë“œë©ë‹ˆë‹¤. XDP ì†Œì¼“ì€ AF_XDP ì£¼ì†Œ íŒ¨ë°€ë¦¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.',
      functions: [], 
      position: { x: 200, y: 50 } 
    },
    { 
      id: 'opt-bpf', 
      label: 'CONFIG_BPF_SYSCALL', 
      level: 'KERNEL_OPTION', 
      desc: 'eBPF ì‹œìŠ¤í…œ ì½œ',
      detailedDesc: 'eBPF(extended Berkeley Packet Filter) ì‹œìŠ¤í…œ ì½œì„ í™œì„±í™”í•©ë‹ˆë‹¤. XDP, TC, kprobe, uprobe ë“±ì—ì„œ eBPF í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ë ¤ë©´ í•„ìˆ˜ì…ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: kernel.unprivileged_bpf_disabled\nUbuntu 24.04 ê¸°ë³¸ê°’:\n- kernel.unprivileged_bpf_disabled = 1 (ë¹„íŠ¹ê¶Œ ì‚¬ìš©ì eBPF ë¹„í™œì„±í™”, ë³´ì•ˆìƒ ê¶Œì¥)\n\nì°¸ê³ : eBPF í”„ë¡œê·¸ë¨ì€ bpf() ì‹œìŠ¤í…œ ì½œì„ í†µí•´ ë¡œë“œë˜ë©°, íŠ¹ê¶Œ ì‚¬ìš©ì(root)ë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ë¹„íŠ¹ê¶Œ ì‚¬ìš©ìê°€ eBPFë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì´ ê°’ì„ 0ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•˜ì§€ë§Œ, ë³´ì•ˆìƒ ê¶Œì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',
      functions: [], 
      position: { x: 400, y: 50 } 
    },
    { 
      id: 'opt-gro', 
      label: 'CONFIG_GRO', 
      level: 'KERNEL_OPTION', 
      desc: 'GRO (Generic Receive Offload)',
      detailedDesc: 'GRO(Generic Receive Offload) ê¸°ëŠ¥ì„ í™œì„±í™”í•©ë‹ˆë‹¤. ì—¬ëŸ¬ ì‘ì€ íŒ¨í‚·ì„ í•˜ë‚˜ì˜ í° íŒ¨í‚·ìœ¼ë¡œ í•©ì³ì„œ ì²˜ë¦¬í•˜ì—¬ CPU ë¶€í•˜ë¥¼ ì¤„ì…ë‹ˆë‹¤. NAPIì™€ í•¨ê»˜ ì‘ë™í•©ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.core.gro_enabled\nUbuntu 24.04 ê¸°ë³¸ê°’:\n- net.core.gro_enabled = 1 (GRO í™œì„±í™”)\n\nì°¸ê³ : GROëŠ” ìˆ˜ì‹  ê²½ë¡œì—ì„œ íŒ¨í‚·ì„ í•©ì¹˜ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ, ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë³„ë¡œ ethtoolì„ í†µí•´ ì œì–´í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.',
      functions: [], 
      position: { x: 600, y: 50 } 
    },
    { 
      id: 'opt-gso', 
      label: 'CONFIG_GSO', 
      level: 'KERNEL_OPTION', 
      desc: 'GSO (Generic Segmentation Offload)',
      detailedDesc: 'GSO(Generic Segmentation Offload) ê¸°ëŠ¥ì„ í™œì„±í™”í•©ë‹ˆë‹¤. í° íŒ¨í‚·ì„ ì—¬ëŸ¬ ì‘ì€ íŒ¨í‚·ìœ¼ë¡œ ë¶„í• í•˜ëŠ” ì‘ì—…ì„ í•˜ë“œì›¨ì–´ë‚˜ ë“œë¼ì´ë²„ë¡œ ì˜¤í”„ë¡œë“œí•˜ì—¬ CPU ë¶€í•˜ë¥¼ ì¤„ì…ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.core.gso_enabled\nUbuntu 24.04 ê¸°ë³¸ê°’:\n- net.core.gso_enabled = 1 (GSO í™œì„±í™”)\n\nì°¸ê³ : GSOëŠ” ì†¡ì‹  ê²½ë¡œì—ì„œ íŒ¨í‚·ì„ ë¶„í• í•˜ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ, ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë³„ë¡œ ethtoolì„ í†µí•´ ì œì–´í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.',
      functions: [], 
      position: { x: 800, y: 50 } 
    },
    { 
      id: 'opt-net-sched', 
      label: 'CONFIG_NET_SCHED', 
      level: 'KERNEL_OPTION', 
      desc: 'íŠ¸ë˜í”½ ì œì–´',
      detailedDesc: 'ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ì œì–´(Traffic Control) ê¸°ëŠ¥ì„ í™œì„±í™”í•©ë‹ˆë‹¤. qdisc, tc ëª…ë ¹ì–´, íŠ¸ë˜í”½ shaping, policing ë“±ì„ ì‚¬ìš©í•˜ë ¤ë©´ í•„ìˆ˜ì…ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.core.default_qdisc, net.core.netdev_max_backlog, net.core.netdev_budget\nì£¼ìš” sysctl ë° Ubuntu 24.04 ê¸°ë³¸ê°’:\n- net.core.default_qdisc = fq (ê¸°ë³¸ íì‰ ê·œìœ¨)\n- net.core.netdev_max_backlog = 1000 (ë„¤íŠ¸ì›Œí¬ ì¥ì¹˜ ë°±ë¡œê·¸ ìµœëŒ€ê°’)\n- net.core.netdev_budget = 300 (NAPI í´ë§ ì˜ˆì‚°)\n- net.core.netdev_budget_usecs = 2000 (NAPI í´ë§ ì˜ˆì‚° ì‹œê°„, ë§ˆì´í¬ë¡œì´ˆ)',
      functions: [], 
      position: { x: 1000, y: 50 } 
    },
    { 
      id: 'opt-tcp-cong', 
      label: 'CONFIG_TCP_CONG_ADVANCED', 
      level: 'KERNEL_OPTION', 
      desc: 'TCP í˜¼ì¡ ì œì–´',
      detailedDesc: 'ê³ ê¸‰ TCP í˜¼ì¡ ì œì–´ ì•Œê³ ë¦¬ì¦˜ì„ í™œì„±í™”í•©ë‹ˆë‹¤. CUBIC, BBR, Reno, Vegas ë“± ë‹¤ì–‘í•œ í˜¼ì¡ ì œì–´ ì•Œê³ ë¦¬ì¦˜ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.ipv4.tcp_congestion_control\nUbuntu 24.04 ê¸°ë³¸ê°’:\n- net.ipv4.tcp_congestion_control = cubic (CUBIC ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©)\n\nì‚¬ìš© ê°€ëŠ¥í•œ ì•Œê³ ë¦¬ì¦˜: cubic, bbr, reno, vegas, westwood, htcp ë“±\nì°¸ê³ : ì‚¬ìš© ê°€ëŠ¥í•œ ì•Œê³ ë¦¬ì¦˜ ëª©ë¡ì€ /proc/sys/net/ipv4/tcp_available_congestion_controlì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
      functions: [], 
      position: { x: 1200, y: 50 } 
    },
    { 
      id: 'opt-ip-route-multipath', 
      label: 'CONFIG_IP_ROUTE_MULTIPATH', 
      level: 'KERNEL_OPTION', 
      desc: 'ë‹¤ì¤‘ ê²½ë¡œ ë¼ìš°íŒ…',
      detailedDesc: 'ë‹¤ì¤‘ ê²½ë¡œ ë¼ìš°íŒ…(Multipath Routing) ì§€ì›ì„ í™œì„±í™”í•©ë‹ˆë‹¤. ì—¬ëŸ¬ ê²½ë¡œë¥¼ í†µí•´ íŠ¸ë˜í”½ì„ ë¶„ì‚°ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.ipv4.fib_multipath.*\nì£¼ìš” sysctl ë° Ubuntu 24.04 ê¸°ë³¸ê°’:\n- net.ipv4.fib_multipath_hash_policy = 0 (í•´ì‹œ ì •ì±…: 0=layer3, 1=layer4)\n- net.ipv4.fib_multipath_use_neigh = 0 (ì´ì›ƒ ì •ë³´ ì‚¬ìš© ë¹„í™œì„±í™”)\n- net.ipv4.fib_multipath_hash_fields = 7 (í•´ì‹œ í•„ë“œ: source IP, dest IP, source port, dest port)',
      functions: [], 
      position: { x: 1400, y: -50 } 
    },
    { 
      id: 'opt-ip-advanced-router', 
      label: 'CONFIG_IP_ADVANCED_ROUTER', 
      level: 'KERNEL_OPTION', 
      desc: 'ê³ ê¸‰ ë¼ìš°íŒ…',
      detailedDesc: 'ê³ ê¸‰ ë¼ìš°íŒ… ê¸°ëŠ¥ì„ í™œì„±í™”í•©ë‹ˆë‹¤. ë‹¤ì¤‘ ë¼ìš°íŒ… í…Œì´ë¸”, ì •ì±… ê¸°ë°˜ ë¼ìš°íŒ…, ë¼ìš°íŒ… ê·œì¹™ ë“±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.ipv4.ip_forward, net.ipv4.conf.*.forwarding, net.ipv4.conf.*.rp_filter\nì£¼ìš” sysctl ë° Ubuntu 24.04 ê¸°ë³¸ê°’:\n- net.ipv4.ip_forward = 0 (IP í¬ì›Œë”© ë¹„í™œì„±í™”)\n- net.ipv4.conf.all.forwarding = 0 (ëª¨ë“  ì¸í„°í˜ì´ìŠ¤ í¬ì›Œë”© ë¹„í™œì„±í™”)\n- net.ipv4.conf.default.forwarding = 0 (ê¸°ë³¸ í¬ì›Œë”© ë¹„í™œì„±í™”)\n- net.ipv4.conf.all.rp_filter = 1 (Reverse Path Filtering í™œì„±í™”)\n- net.ipv4.conf.default.rp_filter = 1 (ê¸°ë³¸ Reverse Path Filtering í™œì„±í™”)',
      functions: [], 
      position: { x: 1400, y: 50 } 
    },
    { 
      id: 'opt-tcp-md5', 
      label: 'CONFIG_TCP_MD5SIG', 
      level: 'KERNEL_OPTION', 
      desc: 'TCP MD5 ì‹œê·¸ë‹ˆì²˜',
      detailedDesc: 'TCP MD5 ì‹œê·¸ë‹ˆì²˜ ì˜µì…˜ì„ í™œì„±í™”í•©ë‹ˆë‹¤. BGP ë“±ì˜ í”„ë¡œí† ì½œì—ì„œ TCP ì—°ê²°ì˜ ë¬´ê²°ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.\n\nê´€ë ¨ sysctl: net.ipv4.tcp_md5sig_enabled (ì»¤ë„ 6.0+)\nUbuntu 24.04 ê¸°ë³¸ê°’:\n- net.ipv4.tcp_md5sig_enabled = 0 (MD5 ì‹œê·¸ë‹ˆì²˜ ë¹„í™œì„±í™”, ë³´ì•ˆìƒ ê¶Œì¥)\n\nì°¸ê³ : ì´ ê¸°ëŠ¥ì€ ì£¼ë¡œ BGP í”„ë¡œí† ì½œì—ì„œ ì‚¬ìš©ë˜ë©°, IPsec ë“± ë” ì•ˆì „í•œ ë°©ë²• ì‚¬ìš©ì´ ê¶Œì¥ë©ë‹ˆë‹¤. MD5ëŠ” ì•”í˜¸í•™ì ìœ¼ë¡œ ì·¨ì•½í•˜ë¯€ë¡œ ìµœì‹  ì‹œìŠ¤í…œì—ì„œëŠ” ì‚¬ìš©ì„ ê¶Œì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',
      functions: [], 
      position: { x: 1600, y: 0 } 
    }
  ],
  edges: [
    // RX ê²½ë¡œ
    { source: 'nic-rx', target: 'nic-rx-ring' },
    { source: 'nic-rx-ring', target: 'driver-rx' },
    { source: 'driver-rx', target: 'napi-rx' },
    { source: 'driver-rx', target: 'xdp-rx' },
    { source: 'xdp-rx', target: 'skb-rx' },
    { source: 'napi-rx', target: 'skb-rx' },
    { source: 'skb-rx', target: 'netfilter-rx' },
    { source: 'netfilter-rx', target: 'routing-rx' },
    { source: 'routing-rx', target: 'socket-rx' },
    { source: 'socket-rx', target: 'tcp-rx-buffer' },
    { source: 'socket-rx', target: 'socket-rx-queue' },
    { source: 'socket-rx-queue', target: 'user-rx' },
    
    // Netfilter Hook ì—°ê²° (RX)
    { source: 'netfilter-rx', target: 'nf:prerouting' },
    { source: 'nf:prerouting', target: 'routing-rx' },
    { source: 'routing-rx', target: 'nf:input' },
    { source: 'routing-rx', target: 'nf:forward' },
    { source: 'nf:input', target: 'socket-rx' },
    
    // TX ê²½ë¡œ
    { source: 'user-tx', target: 'socket-tx-queue' },
    { source: 'socket-tx-queue', target: 'socket-tx' },
    { source: 'socket-tx', target: 'tcp-tx' },
    { source: 'socket-tx', target: 'tcp-tx-buffer' },
    { source: 'tcp-tx-buffer', target: 'tcp-tx' },
    { source: 'tcp-tx', target: 'netfilter-tx-out' },
    { source: 'netfilter-tx-out', target: 'routing-tx' },
    { source: 'routing-tx', target: 'netfilter-tx-post' },
    { source: 'netfilter-tx-post', target: 'tc-tx' },
    { source: 'tc-tx', target: 'qdisc-queue' },
    { source: 'qdisc-queue', target: 'driver-tx' },
    { source: 'driver-tx', target: 'nic-tx-ring' },
    { source: 'nic-tx-ring', target: 'nic-tx' },
    
    // Netfilter Hook ì—°ê²° (TX)
    { source: 'netfilter-tx-out', target: 'nf:output' },
    { source: 'nf:output', target: 'routing-tx' },
    { source: 'routing-tx', target: 'nf:postrouting' },
    { source: 'nf:postrouting', target: 'tc-tx' },
    
    // ì»¤ë„ ì˜µì…˜ ì—°ê²°
    { source: 'opt-net', target: 'driver-rx' },
    { source: 'opt-net', target: 'driver-tx' },
    { source: 'opt-inet', target: 'socket-rx' },
    { source: 'opt-inet', target: 'socket-tx' },
    { source: 'opt-inet', target: 'routing-rx' },
    { source: 'opt-inet', target: 'routing-tx' },
    { source: 'opt-ipv6', target: 'routing-rx' },
    { source: 'opt-ipv6', target: 'routing-tx' },
    { source: 'opt-netfilter', target: 'netfilter-rx' },
    { source: 'opt-netfilter', target: 'netfilter-tx-out' },
    { source: 'opt-netfilter', target: 'netfilter-tx-post' },
    { source: 'opt-nf-conntrack', target: 'nf:prerouting' },
    { source: 'opt-nf-conntrack', target: 'nf:input' },
    { source: 'opt-nf-conntrack', target: 'nf:output' },
    { source: 'opt-nf-nat', target: 'nf:prerouting' },
    { source: 'opt-nf-nat', target: 'nf:postrouting' },
    { source: 'opt-xdp', target: 'xdp-rx' },
    { source: 'opt-bpf', target: 'xdp-rx' },
    { source: 'opt-bpf', target: 'tc-tx' },
    { source: 'opt-gro', target: 'napi-rx' },
    { source: 'opt-gso', target: 'tcp-tx' },
    { source: 'opt-net-sched', target: 'tc-tx' },
    { source: 'opt-tcp-cong', target: 'socket-rx' },
    { source: 'opt-tcp-cong', target: 'socket-tx' },
    { source: 'opt-ip-route-multipath', target: 'routing-rx' },
    { source: 'opt-ip-route-multipath', target: 'routing-tx' },
    { source: 'opt-ip-advanced-router', target: 'routing-rx' },
    { source: 'opt-ip-advanced-router', target: 'routing-tx' },
    { source: 'opt-tcp-md5', target: 'socket-rx' },
    { source: 'opt-tcp-md5', target: 'socket-tx' }
  ]
};

// Cytoscape ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
const cy = cytoscape({
  container: document.getElementById('cy'),
  
  wheelSensitivity: 0.15,
  minZoom: 0.2,
  maxZoom: 4,
  panningEnabled: true,
  zoomingEnabled: true,
  
  style: [
    {
      selector: 'node',
      style: {
        'label': 'data(label)',
        'text-valign': 'center',
        'text-halign': 'center',
        'color': '#fff',
        'background-color': 'data(color)',
        'width': 140,
        'height': 60,
        'font-size': 13,
        'font-weight': 'bold',
        'shape': 'roundrectangle',
        'border-width': 2,
        'border-color': '#fff',
        'text-wrap': 'wrap',
        'text-max-width': 130
      }
    },
    {
      selector: 'edge',
      style: {
        'width': 3,
        'line-color': '#60a5fa',
        'target-arrow-color': '#60a5fa',
        'target-arrow-shape': 'triangle',
        'curve-style': 'bezier',
        'opacity': 0.7
      }
    },
    {
      selector: 'edge[sourceLevel = "KERNEL_OPTION"]',
      style: {
        'line-color': LEVEL_COLORS.KERNEL_OPTION,
        'target-arrow-color': LEVEL_COLORS.KERNEL_OPTION,
        'line-style': 'dashed'
      }
    },
    {
      selector: 'node[level = "HARDWARE"]',
      style: {
        'background-color': LEVEL_COLORS.HARDWARE
      }
    },
    {
      selector: 'node[level = "DRIVER"]',
      style: {
        'background-color': LEVEL_COLORS.DRIVER
      }
    },
    {
      selector: 'node[level = "KERNEL_LOW"]',
      style: {
        'background-color': LEVEL_COLORS.KERNEL_LOW
      }
    },
    {
      selector: 'node[level = "NETFILTER"]',
      style: {
        'background-color': LEVEL_COLORS.NETFILTER
      }
    },
    {
      selector: 'node[level = "ROUTING"]',
      style: {
        'background-color': LEVEL_COLORS.ROUTING
      }
    },
    {
      selector: 'node[level = "SOCKET"]',
      style: {
        'background-color': LEVEL_COLORS.SOCKET
      }
    },
    {
      selector: 'node[level = "XDP"]',
      style: {
        'background-color': LEVEL_COLORS.XDP
      }
    },
    {
      selector: 'node[level = "TC"]',
      style: {
        'background-color': LEVEL_COLORS.TC
      }
    },
    {
      selector: 'node[level = "BUFFER"]',
      style: {
        'background-color': LEVEL_COLORS.BUFFER
      }
    },
    {
      selector: 'node[level = "USER"]',
      style: {
        'background-color': LEVEL_COLORS.USER
      }
    },
    {
      selector: 'node[level = "KERNEL_OPTION"]',
      style: {
        'background-color': LEVEL_COLORS.KERNEL_OPTION,
        'width': 180,
        'height': 50,
        'font-size': 11
      }
    }
  ],
  
  elements: {
    nodes: networkData.nodes.map(node => ({
      data: {
        id: node.id,
        label: node.label,
        level: node.level,
        desc: node.desc,
        detailedDesc: node.detailedDesc || '',
        functions: node.functions || [],
        color: LEVEL_COLORS[node.level] || '#666'
      },
      position: node.position,
      classes: node.parent ? 'detail-node' : 'main-node'
    })),
    edges: networkData.edges.map(edge => {
      const sourceNode = networkData.nodes.find(n => n.id === edge.source);
      return {
        data: {
          source: edge.source,
          target: edge.target,
          sourceLevel: sourceNode ? sourceNode.level : null
        }
      };
    })
  },
  
  layout: {
    name: 'preset'
  }
});

// ì •ë³´ íŒ¨ë„ ì—…ë°ì´íŠ¸
const info = document.getElementById('info');
const zoomLevelDisplay = document.getElementById('zoom-level');

function updateInfoPanel(node) {
  const level = node.data('level');
  const levelNames = {
    'HARDWARE': 'í•˜ë“œì›¨ì–´',
    'DRIVER': 'ë“œë¼ì´ë²„',
    'KERNEL_LOW': 'ì»¤ë„ (ì €ìˆ˜ì¤€)',
    'NETFILTER': 'Netfilter',
    'ROUTING': 'ë¼ìš°íŒ…',
    'SOCKET': 'ì†Œì¼“',
    'XDP': 'XDP',
    'TC': 'íŠ¸ë˜í”½ ì œì–´',
    'BUFFER': 'ë²„í¼',
    'USER': 'ì‚¬ìš©ì ê³µê°„',
    'KERNEL_OPTION': 'ì»¤ë„ ì˜µì…˜'
  };
  
  let html = `
    <h3>${node.data('label')}</h3>
    <p><span class="level-badge" style="background: ${node.data('color')}; color: #fff;">${levelNames[level] || level}</span></p>
    <p class="desc"><strong>${node.data('desc')}</strong></p>
  `;
  
  const detailedDesc = node.data('detailedDesc');
  if (detailedDesc) {
    // ì¤„ë°”ê¿ˆ(\n)ì„ <br>ë¡œ ë³€í™˜
    const formattedDesc = detailedDesc.replace(/\n/g, '<br>');
    html += `
      <div style="margin-top: 16px;">
        <p style="color: #9ca3af; line-height: 1.8; font-size: 14px;">${formattedDesc}</p>
      </div>
    `;
  }
  
  const functions = node.data('functions');
  if (functions && functions.length > 0) {
    html += `
      <div style="margin-top: 16px;">
        <p><strong style="color: #7dd3fc;">ì£¼ìš” í•¨ìˆ˜:</strong></p>
        <ul class="function-list">
          ${functions.map(fn => `<li>${fn}</li>`).join('')}
        </ul>
      </div>
    `;
  }
  
  info.innerHTML = html;
}

// ë…¸ë“œ í´ë¦­ ì´ë²¤íŠ¸
cy.on('tap', 'node', evt => {
  const node = evt.target;
  updateInfoPanel(node);
  
  // í´ë¦­ëœ ë…¸ë“œì™€ ì—°ê²°ëœ ëª¨ë“  ë…¸ë“œ ì°¾ê¸° (neighborhood)
  const connectedNodes = node.neighborhood('node');
  const highlightedNodes = connectedNodes.add(node); // ì—°ê²°ëœ ë…¸ë“œ + í´ë¦­ëœ ë…¸ë“œ
  
  // ëª¨ë“  ë…¸ë“œ ì²˜ë¦¬
  cy.nodes().forEach(n => {
    if (highlightedNodes.has(n)) {
      // ê°•ì¡°ëœ ë…¸ë“œ: ë¶‰ì€ ìœ¤ê³½ì„ 
      if (n === node) {
        n.style({
          'border-width': 5,
          'border-color': '#ef4444',
          'background-color': n.data('color'),
          'opacity': 1
        });
      } else {
        n.style({
          'border-width': 4,
          'border-color': '#f87171',
          'background-color': n.data('color'),
          'opacity': 1
        });
      }
    } else {
      // ê°•ì¡°ë˜ì§€ ì•Šì€ ë…¸ë“œ: ì§„íšŒìƒ‰
      n.style({
        'border-width': 2,
        'border-color': '#fff',
        'background-color': '#4b5563',
        'opacity': 0.5
      });
    }
  });
  
  // ëª¨ë“  ì—£ì§€ ì²˜ë¦¬
  cy.edges().forEach(e => {
    const source = e.source();
    const target = e.target();
    const isHighlighted = highlightedNodes.has(source) || highlightedNodes.has(target);
    
    if (isHighlighted) {
      // ê°•ì¡°ëœ ì—£ì§€: ì›ë˜ ìƒ‰ìƒ ìœ ì§€
      const sourceLevel = e.data('sourceLevel');
      if (sourceLevel === 'KERNEL_OPTION') {
        e.style({
          'line-color': LEVEL_COLORS.KERNEL_OPTION,
          'target-arrow-color': LEVEL_COLORS.KERNEL_OPTION,
          'opacity': 0.7
        });
      } else {
        e.style({
          'line-color': '#60a5fa',
          'target-arrow-color': '#60a5fa',
          'opacity': 0.7
        });
      }
    } else {
      // ê°•ì¡°ë˜ì§€ ì•Šì€ ì—£ì§€: ì§„íšŒìƒ‰
      e.style({
        'line-color': '#6b7280',
        'target-arrow-color': '#6b7280',
        'opacity': 0.3
      });
    }
  });
});

// ë°°ê²½ í´ë¦­ ì‹œ ì›ë˜ ìƒ‰ìƒìœ¼ë¡œ ë³µì›
cy.on('tap', evt => {
  if (evt.target === cy) {
    // ëª¨ë“  ë…¸ë“œë¥¼ ì›ë˜ ìƒ‰ìƒìœ¼ë¡œ ë³µì›
    cy.nodes().forEach(n => {
      n.style({
        'border-width': 2,
        'border-color': '#fff',
        'background-color': n.data('color'),
        'opacity': 1
      });
    });
    
    // ëª¨ë“  ì—£ì§€ë¥¼ ì›ë˜ ìƒ‰ìƒìœ¼ë¡œ ë³µì›
    cy.edges().forEach(e => {
      const sourceLevel = e.data('sourceLevel');
      if (sourceLevel === 'KERNEL_OPTION') {
        e.style({
          'line-color': LEVEL_COLORS.KERNEL_OPTION,
          'target-arrow-color': LEVEL_COLORS.KERNEL_OPTION,
          'opacity': 0.7
        });
      } else {
        e.style({
          'line-color': '#60a5fa',
          'target-arrow-color': '#60a5fa',
          'opacity': 0.7
        });
      }
    });
  }
});

// Zoom ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
cy.on('zoom', () => {
  const z = cy.zoom();
  zoomLevelDisplay.textContent = `Zoom: ${z.toFixed(2)}x`;
  
  // ëª¨ë“  ë…¸ë“œëŠ” í•­ìƒ í‘œì‹œë¨ (ì¤Œ ë ˆë²¨ê³¼ ë¬´ê´€)
});

// í‚¤ë³´ë“œ ì´ë²¤íŠ¸
document.addEventListener('keydown', e => {
  const pan = cy.pan();
  const step = 80;
  const zoomStep = 0.2;

  switch (e.key) {
    case 'ArrowUp':
      cy.pan({ x: pan.x, y: pan.y + step });
      break;
    case 'ArrowDown':
      cy.pan({ x: pan.x, y: pan.y - step });
      break;
    case 'ArrowLeft':
      cy.pan({ x: pan.x + step, y: pan.y });
      break;
    case 'ArrowRight':
      cy.pan({ x: pan.x - step, y: pan.y });
      break;
    case '+':
    case '=':
      cy.zoom(cy.zoom() + zoomStep);
      break;
    case '-':
    case '_':
      cy.zoom(cy.zoom() - zoomStep);
      break;
    case 'Escape':
      cy.fit();
      break;
  }
});

// ì´ˆê¸° ì „ì²´ ë³´ê¸°
cy.ready(() => {
  cy.fit(50);
  zoomLevelDisplay.textContent = `Zoom: ${cy.zoom().toFixed(2)}x`;
});

// ë²”ë¡€ ì¶”ê°€
const legendHtml = `
  <div class="legend">
    <h3>ê³„ì¸µë³„ ìƒ‰ìƒ</h3>
    <div class="legend-item">
      <div class="legend-color" style="background: ${LEVEL_COLORS.HARDWARE};"></div>
      <span>í•˜ë“œì›¨ì–´ (NIC)</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background: ${LEVEL_COLORS.DRIVER};"></div>
      <span>ë“œë¼ì´ë²„</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background: ${LEVEL_COLORS.KERNEL_LOW};"></div>
      <span>ì»¤ë„ ì €ìˆ˜ì¤€ (NAPI, skb)</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background: ${LEVEL_COLORS.XDP};"></div>
      <span>XDP</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background: ${LEVEL_COLORS.NETFILTER};"></div>
      <span>Netfilter</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background: ${LEVEL_COLORS.ROUTING};"></div>
      <span>ë¼ìš°íŒ…</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background: ${LEVEL_COLORS.SOCKET};"></div>
      <span>ì†Œì¼“</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background: ${LEVEL_COLORS.TC};"></div>
      <span>íŠ¸ë˜í”½ ì œì–´ (TC/qdisc)</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background: ${LEVEL_COLORS.BUFFER};"></div>
      <span>ë²„í¼ (Buffer/Queue)</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background: ${LEVEL_COLORS.USER};"></div>
      <span>ì‚¬ìš©ì ê³µê°„ (User-space)</span>
    </div>
    <div class="legend-item">
      <div class="legend-color" style="background: ${LEVEL_COLORS.KERNEL_OPTION};"></div>
      <span>ì»¤ë„ ì˜µì…˜ (Kernel Option)</span>
    </div>
  </div>
`;

info.innerHTML += legendHtml;
</script>

</body>
</html>

